<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>留言板</title>
<style>
body {
    background-color: rgb(46, 73, 109);
    color: #ffffff;
}
.txtFileName {
    color: rgb(68, 0, 0);
    background-color: antiquewhite;
}

.txtFileContent {
    color: rgb(255, 255, 255);
    background-color: rgb(45, 33, 145);
    padding: 10px;
    word-break: break-all;
    white-space: pre-wrap; 
}

.greenBox {
    background-color: rgb(135, 135, 135);
    padding: 10px;
    margin-bottom: 10px;
}
</style>
</head>
<body>

<h3>静态留言板</h3>
<div id="embeddedTexts">
<!-- 在这里嵌入文本文件内容 -->
</div>

<script>
fetchTextFiles();

function fetchTextFiles() {
    fetchFilesInDirectory('text')
        .then(files => {
            const txtFiles = files.filter(file => /\.txt$/.test(file));
            if (txtFiles.length > 0) {
                const promises = txtFiles.map(txtFile => {
                    return fetch(`text/${txtFile}`)
                        .then(response => response.text())
                        .then(text => {
                            return { fileName: txtFile, content: text };
                        });
                });
                Promise.all(promises)
                    .then(contents => {
                        const embeddedTexts = document.getElementById('embeddedTexts');
                        contents.forEach(content => {
                            const preElement = document.createElement('pre');
                            preElement.classList.add('greenBox'); 
                            preElement.innerHTML = `<span class="txtFileName">${content.fileName}:</span><br><div class="txtFileContent">${content.content}</div>`;
                            embeddedTexts.appendChild(preElement);
                        });
                    })
                    .catch(error => {
                        console.error('获取文本文件内容时出错：', error);
                    });
            } else {
                console.error('未找到以 .txt 结尾的文本文件。');
            }
        })
        .catch(error => {
            console.error('获取文件列表时出错：', error);
        });
}

async function fetchFilesInDirectory(directory) {
    const response = await fetch(directory);
    const text = await response.text();
    const matches = text.match(/href="([^"]+)"/g);
    if (matches) {
        return matches.map(match => decodeURIComponent(match.replace('href="', '').replace('"', '')));
    } else {
        return [];
    }
}
</script>
</body>
</html>
